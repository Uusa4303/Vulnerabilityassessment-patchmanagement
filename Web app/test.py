# ... (previous code)
import subprocess
import re
target_ip="192.168.6.140"
def run_nmap_scan(target_ip):
    try:
        # Run Nmap scan using subprocess
        result = subprocess.run(['sudo', 'nmap', '-p-', '-A', '--open', target_ip], capture_output=True, text=True)
        
        # Extract lines related to open ports
        open_ports_lines = re.findall(r'(\d+\/[a-zA-Z]+)\s+open.*', result.stdout)
        open_ports = "\n".join(open_ports_lines) if open_ports_lines else "No open ports found"

        # Extract server version and OS information
        version_os_info = re.search(r'Nmap scan report for.*\nHost is up.*\n(\S+).*\nOS details: (.+?)\nNmap done', result.stdout, re.DOTALL)
        server_version = version_os_info.group(1) if version_os_info else "Server version not detected"
        os_details = version_os_info.group(2) if version_os_info else "OS details not detected"

        result_info = {
            'open_ports': open_ports,
            'server_version': server_version,
            'os_details': os_details
        }

        return result_info
    except FileNotFoundError:
        return "Nmap not found. Make sure Nmap is installed on your system."
nmap_result=run_nmap_scan(target_ip)
print(nmap_result)
# ... (remaining code)
